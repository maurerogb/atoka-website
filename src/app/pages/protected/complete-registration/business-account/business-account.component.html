<div class="w-[600px] h-full justify-center mt-5 text-center">
  <img
    class="h-[100px] w-full pt-[20px]"
    src="assets/svg/directionpost.svg"
    alt="logo"
  />
  <div class="text-[#005677] h-[100px] gap-4 w-full mt-6 justify-items-center">
    <p class="font-bold text-center text-[24px]">Business Account</p>
    <p class="font-normal pt-0 text-[14px]">
      Please select the account type that suite you.
    </p>
  </div>
  <div class="text-left" [formGroup]="businessForm">
    <form class="mb-6">      
      <p class="text-sm text-center font-light text-red-500" *ngIf="message">{{ message }}</p>
      <div class="grid grid-cols-2 gap-x-4">
        <div class="control">
          <mat-label class="text-sm">Business Name*</mat-label>
          <mat-form-field
            class="w-full rounded-xl"
            appearance="fill"
            floatLabel="always"
          >
            <input
              matInput
              formControlName="businessName"
              placeholder="Enter Business Name"
              type="text"
              name="firstname"
              id="firstname"
            />
            <mat-error *ngIf="businessForm.get('businessName')?.hasError('required') && (businessForm.get('businessName')?.dirty || businessForm.get('businessName')?.touched)">
              Business name is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="control">
          <mat-label class="text-sm">Business Type*</mat-label>
          <mat-form-field
            class="w-full rounded-xl"
            appearance="fill"
            floatLabel="always"
          >
            <mat-select
              [placeholder]="'Select Business Type'"
              formControlName="businessType"
            >
              @for (item of businessTypes; track item.id) {
              <mat-option [value]="item.id"> {{ item.name }} </mat-option>
              }
            </mat-select>
            <mat-error *ngIf="businessForm.get('businessType')?.hasError('required') && (businessForm.get('businessType')?.dirty || businessForm.get('businessType')?.touched)">
              Business type is required
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="grid grid-cols gap-x-4">
        <div class="control">
          <mat-label class="text-sm">Phone Number*</mat-label>
          <mat-form-field
            class="w-full rounded-xl"
            appearance="fill"
            floatLabel="always"
          >
            <input
              matInput
              formControlName="phoneNumber"
              placeholder="Enter Phone Number"
              type="text"
              name="phoneNumber"
              id="phoneNumber"
            />
            <mat-error *ngIf="businessForm.get('phoneNumber')?.hasError('required') && (businessForm.get('phoneNumber')?.dirty || businessForm.get('phoneNumber')?.touched)">
              Phone number is required
            </mat-error>
            <mat-error *ngIf="businessForm.get('phoneNumber')?.hasError('pattern') && (businessForm.get('phoneNumber')?.dirty || businessForm.get('phoneNumber')?.touched)">
              Please enter a valid phone number
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="grid grid-cols gap-x-4">
        <div class="control">
          <mat-label class="text-sm">Official Email Address*</mat-label>
          <mat-form-field
            class="w-full rounded-xl"
            appearance="fill"
            floatLabel="always"
          >
            <input
              matInput
              formControlName="businessEmail"
              placeholder="Enter Official Email Address"
              type="text"
              name="firstname"
              id="firstname"
            />
            <mat-error *ngIf="businessForm.get('businessEmail')?.hasError('required') && (businessForm.get('businessEmail')?.dirty || businessForm.get('businessEmail')?.touched)">
              Please enter your email address
            </mat-error>
            <mat-error *ngIf="businessForm.get('businessEmail')?.hasError('email') && (businessForm.get('businessEmail')?.dirty || businessForm.get('businessEmail')?.touched)">
              Please enter a valid email address
            </mat-error>
            <!-- <mat-error>Official Email Address is required</mat-error> -->
          </mat-form-field>
        </div>
        <div class="grid grid-cols gap-x-4">
          <div class="control">
            <mat-checkbox
              formControlName="isBusinessReg"
              (change)="uploadDocument($event.checked)"
              color="primary"
              class="text-sm -mt-2 -ml-2 text-cyan-50"
              ><span class="font-thin">
                Tick if your Business Registered with CAC</span
              >
            </mat-checkbox>
            <mat-error
              *ngIf="businessForm.get('isBusinessReg')?.hasError('required') && (businessForm.get('isBusinessReg')?.dirty || businessForm.get('isBusinessReg')?.touched)">
              Please indicate if your business is registered with CAC.
            </mat-error>
          </div>
        </div>
      </div>
      @if(uploadCAC){
      <div class="grid grid-cols gap-x-4 mt-6 mb-6">
        <div class="control">
          <mat-label class="text-sm">Business registration number*</mat-label>
          <mat-form-field
            class="w-full rounded-xl"
            appearance="fill"
            floatLabel="always"
          >
            <input
              matInput
              formControlName="businessRegNo"
              placeholder="Enter Business Registration Number"
              type="number"
              name="businessRegNo"
              id="businessRegNo"
            />            
            <mat-error *ngIf="businessForm.get('businessRegNo')?.hasError('required') && (businessForm.get('businessRegNo')?.dirty || businessForm.get('businessRegNo')?.touched)">
              Business registration number is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="control">
          <mat-label
            >Upload Certificate of Incorporation (CAC) for {{ businessForm.get("businessName")?.value || 'your organization' }}?*</mat-label
          >
          <app-upload-file
            [fileType]="'file'"
            (uploadedFile)="setCACocument($event)"
          ></app-upload-file>
        </div>
      </div>
      }

      <div class="grid grid-cols gap-x-4 mt-6 mb-6">
        <div class="control">
          <mat-label>Upload your business Logo</mat-label>
          <app-upload-file
            [fileType]="'file'"
            (uploadedFile)="setBusinessLogo($event)"
          ></app-upload-file>
        </div>
      </div>
      <div class="control">
        <mat-label class="text-sm"
          >What role do you play at
          {{ businessForm.get("businessName")?.value || 'your organization' }}?*</mat-label
        >
        <mat-form-field
          class="w-full rounded-xl"
          appearance="fill"
          floatLabel="always"
        >
          <mat-select
            [placeholder]="'Select Role'"
            formControlName="roleInBusiness"
          >
            @for (item of businessRoles; track item) {
            <mat-option [value]="item.id">{{ item.name }} </mat-option>
            }
          </mat-select>
          <mat-error
            *ngIf="businessForm.get('roleInBusiness')?.hasError('required') && (businessForm.get('roleInBusiness')?.dirty || businessForm.get('roleInBusiness')?.touched)">
            Your role is required.
          </mat-error>
        </mat-form-field>
      </div>

      <div class="grid gap-x-4">
        <app-atoka-search
          [labelName]="labelName"
          [addressCode]="addressCode"
          (returnCode)="setAddressCode($event)"
        ></app-atoka-search>
        <div class="mt-5 mb-5 text-center">
          <a href="javascript:void(0)" class="primary" (click)="showForm()"
            >Don't have ATOKA ? <b> Enter address manually</b></a
          >
        </div>
        <app-address-form
          [hideForm]="hideForm"
          (showFormState)="setHideForm($event)"
          (formMessage)="message = $event"
        >
        </app-address-form>
      </div>
      <mat-error
        *ngIf="businessForm.get('businessAddress')?.hasError('required') && (businessForm.get('businessAddress')?.dirty || businessForm.get('businessAddress')?.touched)">
        Business address is required.
      </mat-error>

      <mat-checkbox formControlName="hasAcceptedTC" color="primary" class="text-sm -mt-2 -ml-2">
        <span class="text-primary">By signing up you agree to our </span>
        <a href="javascript:void(0)" class="font-[12px]">Terms & Conditions </a>
        and <a href="javascript:void(0)" class="font-[12px]">Privacy Policy </a>
      </mat-checkbox>
      <mat-error
        *ngIf="businessForm.get('hasAcceptedTC')?.hasError('required') && (businessForm.get('hasAcceptedTC')?.dirty || businessForm.get('hasAcceptedTC')?.touched)">
        You must accept the terms and conditions to continue.
      </mat-error>

      <div class="flex flex-col items-center mt-8 gap-y-4">
        <div class="flex flex-col w-full items-center mt-8 gap-y-4">
          <button
            class="font-[16px] mb-12 w-full"
            type="button"
            mat-flat-button
            color="primary"
            [disabled]="businessForm.invalid"
            (click)="saveBusinessInfo()"
          >
            Continue
            <app-loader *ngIf="loadingService.isLoading$ | async"></app-loader>
            <!-- <mat-spinner class="text-[12px]" *ngIf="loading" ></mat-spinner> -->
          </button>
        </div>
      </div>
    </form>
  </div>
</div>

<app-loader *ngIf="loadingService.isLoading$ | async"></app-loader>
